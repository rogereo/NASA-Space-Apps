<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exoplanet ML â€“ MVP</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="container">
    <header>
      <h1>Exoplanet Classifier (MVP)</h1>
      <p>Status: <strong class="{{ 'ok' if model_loaded else 'warn' }}">
        {{ 'Model loaded' if model_loaded else 'No trained model yet (using heuristic)' }}
      </strong></p>
    </header>

    <section class="card">
      <h2>Try a Prediction</h2>
      <p>Enter feature values below (add/remove fields as needed).</p>
      <form id="predict-form">
        <div class="grid">
          <label>koi_model_snr <input type="number" step="any" name="koi_model_snr" value="25.8"></label>
          <label>koi_depth (ppm) <input type="number" step="any" name="koi_depth" value="875"></label>
          <label>koi_duration (hours) <input type="number" step="any" name="koi_duration" value="3.1"></label>
          <label>koi_prad (Earth radii) <input type="number" step="any" name="koi_prad" value="2.2"></label>
          <label>koi_period (days) <input type="number" step="any" name="koi_period" value="10.5"></label>
          <label>koi_teq (K) <input type="number" step="any" name="koi_teq" value="600"></label>
          <label>koi_steff (K) <input type="number" step="any" name="koi_steff" value="5800"></label>
          <label>koi_srad (Solar radii) <input type="number" step="any" name="koi_srad" value="1.0"></label>
          <label>koi_kepmag <input type="number" step="any" name="koi_kepmag" value="15.5"></label>
        </div>
        <button type="submit">Predict</button>
      </form>
      <pre id="result" class="result"></pre>
    </section>

    <section class="card">
      <h2>API</h2>
      <p>POST <code>/predict</code> with JSON payload:</p>
<pre>{
  "features": {
    "koi_model_snr": 25.8,
    "koi_depth": 875,
    "koi_duration": 3.1,
    "koi_prad": 2.2
  }
}</pre>
      <p>Response:</p>
<pre>{
  "ok": true,
  "prediction": 1,
  "proba": 0.72,
  "used_features": {...}
}</pre>
    </section>

    <footer>
      <a href="/health" target="_blank">/health</a>
    </footer>
  </div>

  <script>
    const form = document.getElementById('predict-form');
    const result = document.getElementById('result');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = new FormData(form);
      const features = {};
      for (const [k, v] of data.entries()) { if (v !== '') features[k] = Number(v); }
      const res = await fetch('/predict', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({features})
      });
      const json = await res.json();
      result.textContent = JSON.stringify(json, null, 2);
    });
  </script>
</body>
</html>
